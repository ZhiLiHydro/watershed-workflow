

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>API Documentation &mdash; Watershed Workflow 0.1 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Data Sources" href="sources.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Watershed Workflow
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/mesh_coweeta.html">Example: mesh a delineated watershed</a></li>
<li class="toctree-l1"><a class="reference internal" href="gallery.html">Gallery</a></li>
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="concepts.html">Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="scripts.html">Scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="sources.html">Data Sources</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">API Documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#data-structures-api-and-concepts">Data Structures API and concepts</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#module-workflow.crs">CRS</a></li>
<li class="toctree-l3"><a class="reference internal" href="#shapes-and-shapely">shapes and shapely</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-workflow.hilev">High Level API</a></li>
<li class="toctree-l2"><a class="reference internal" href="#sources-api">Sources API</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-workflow.utils">utils API</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Watershed Workflow</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>API Documentation</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/api.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="api-documentation">
<h1>API Documentation<a class="headerlink" href="#api-documentation" title="Permalink to this headline">¶</a></h1>
<div class="section" id="data-structures-api-and-concepts">
<h2>Data Structures API and concepts<a class="headerlink" href="#data-structures-api-and-concepts" title="Permalink to this headline">¶</a></h2>
<div class="section" id="module-workflow.crs">
<span id="crs"></span><h3>CRS<a class="headerlink" href="#module-workflow.crs" title="Permalink to this headline">¶</a></h3>
<p>Coordinate Reference System conversions.</p>
<p>Coordinate Reference Systems (CRSs) differ across datasets, and
standardizing and managing these across the workflow is a necessary
technical detail.  That said, rarely does the user care what
coordinate system is being used, as long as it is appropriate for the
watershed in question.  Watershed Workflow aims to make using datasets
in different CRSs as streamlined as possible.  Typically, a workflow
will pick a CRS based upon either a default for the region or by
simply using the CRS of the shapefile that specifies the watershed
boundary.  This CRS is the passed into each function that acquires
more data, and that data’s coordinates are changed to the CRS
requested.</p>
<p>This process is made more difficult by the fact that most python GIS
packages provide their own class object to store the CRS.  This said,
nearly all of them are based, to some degree, on the <cite>proj4</cite> library
and its python wrapper, <cite>pyproj</cite> for coordinate transformations.
Watershed Workflow uses the <cite>pyproj.Proj</cite> class as its own internal
representation of coordinate system, and provides methods for mapping
<cite>fiona</cite> (shapefiles), <cite>rasterio</cite> (rasters), and <cite>cartopy</cite> (plotting)
CRS objects to and from this type.  While this is typically done by
calling functions from those libraries, standardizing the API makes
dealing with these packages in an integrated form much simpler.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">We intend to use the pyproj.Proj object as our standard.  But for
now we are trying to avoid hard-coding that, so internal code
should avoid using that knowledge, and instead map to and from
<cite>pyproj.Proj</cite> objects using the provided interface.</p>
</div>
<dl class="function">
<dt id="workflow.crs.daymet_crs">
<code class="descclassname">workflow.crs.</code><code class="descname">daymet_crs</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/workflow/crs.html#daymet_crs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#workflow.crs.daymet_crs" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns teh CRS used by DayMet files.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>out</strong> <span class="classifier-delimiter">:</span> <span class="classifier">crs-type</span></dt>
<dd><p class="first last">The DayMet CRS.  The user should not care what this is.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="workflow.crs.default_alaska_crs">
<code class="descclassname">workflow.crs.</code><code class="descname">default_alaska_crs</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/workflow/crs.html#default_alaska_crs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#workflow.crs.default_alaska_crs" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a default CRS that is functionally useful for Alaska.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>out</strong> <span class="classifier-delimiter">:</span> <span class="classifier">crs-type</span></dt>
<dd><p class="first last">The default CRS.  The user should not care what this is (if
you do, don’t use the default!) but it is EPSG:3338.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="workflow.crs.default_crs">
<code class="descclassname">workflow.crs.</code><code class="descname">default_crs</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/workflow/crs.html#default_crs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#workflow.crs.default_crs" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a default CRS that is functionally useful for North America.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>out</strong> <span class="classifier-delimiter">:</span> <span class="classifier">crs-type</span></dt>
<dd><p class="first last">The default CRS.  The user should not care what this is (if
you do, don’t use the default!) but it is EPSG:5070.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="workflow.crs.equal">
<code class="descclassname">workflow.crs.</code><code class="descname">equal</code><span class="sig-paren">(</span><em>crs1</em>, <em>crs2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/workflow/crs.html#equal"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#workflow.crs.equal" title="Permalink to this definition">¶</a></dt>
<dd><p>Tries to guess at the equality of two CRS objects.</p>
<p>Note this is not trivial, just checking strings or dicts results
in false-negatives.  Furthermore, this implementation may not be
perfect, but it works for all those currently tested.  Please
report bugs!</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>crs1,crs2</strong> <span class="classifier-delimiter">:</span> <span class="classifier">crs-type</span></dt>
<dd><p class="first last">Input workflow CRS objects.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>out</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool</span></dt>
<dd><p class="first last">Are equal?</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="workflow.crs.from_cartopy">
<code class="descclassname">workflow.crs.</code><code class="descname">from_cartopy</code><span class="sig-paren">(</span><em>crs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/workflow/crs.html#from_cartopy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#workflow.crs.from_cartopy" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts a cartopy CRS to a workflow CRS.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>epsg</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd><p class="first last">An EPSG code. (see <a href="#id1"><span class="problematic" id="id2">`https://epsg.io`_</span></a>)</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>out</strong> <span class="classifier-delimiter">:</span> <span class="classifier">crs-type</span></dt>
<dd><p class="first last">Equivalent workflow CRS.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="workflow.crs.from_epsg">
<code class="descclassname">workflow.crs.</code><code class="descname">from_epsg</code><span class="sig-paren">(</span><em>epsg</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/workflow/crs.html#from_epsg"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#workflow.crs.from_epsg" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts from an EPSG code to a workflow CRS.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>epsg</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd><p class="first last">An EPSG code. (see <a href="#id3"><span class="problematic" id="id4">`https://epsg.io`_</span></a>)</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>out</strong> <span class="classifier-delimiter">:</span> <span class="classifier">crs-type</span></dt>
<dd><p class="first last">Equivalent workflow CRS.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="workflow.crs.from_fiona">
<code class="descclassname">workflow.crs.</code><code class="descname">from_fiona</code><span class="sig-paren">(</span><em>crs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/workflow/crs.html#from_fiona"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#workflow.crs.from_fiona" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts a fiona CRS to the workflow CRS standard.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>crs</strong> <span class="classifier-delimiter">:</span> <span class="classifier">fiona-crs-dict</span></dt>
<dd><p class="first last">Input fiona CRS, which is a dictionary containing an EPSG
code.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>out</strong> <span class="classifier-delimiter">:</span> <span class="classifier">crs-type</span></dt>
<dd><p class="first last">Equivalent workflow CRS.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="workflow.crs.from_proj">
<code class="descclassname">workflow.crs.</code><code class="descname">from_proj</code><span class="sig-paren">(</span><em>crs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/workflow/crs.html#from_proj"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#workflow.crs.from_proj" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts a Proj4 CRS to the workflow CRS standard.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>crs</strong> <span class="classifier-delimiter">:</span> <span class="classifier">pyproj.Proj</span></dt>
<dd><p class="first last">Input proj CRS object.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>out</strong> <span class="classifier-delimiter">:</span> <span class="classifier">crs-type</span></dt>
<dd><p class="first last">Equivalent workflow CRS.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="workflow.crs.from_rasterio">
<code class="descclassname">workflow.crs.</code><code class="descname">from_rasterio</code><span class="sig-paren">(</span><em>crs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/workflow/crs.html#from_rasterio"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#workflow.crs.from_rasterio" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts from rasterio CRS to the workflow CRS standard.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>crs</strong> <span class="classifier-delimiter">:</span> <span class="classifier">rasterio-crs-object</span></dt>
<dd><p class="first last">Input rasterio crs.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>out</strong> <span class="classifier-delimiter">:</span> <span class="classifier">crs-type</span></dt>
<dd><p class="first last">Equivalent workflow CRS.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="workflow.crs.from_string">
<code class="descclassname">workflow.crs.</code><code class="descname">from_string</code><span class="sig-paren">(</span><em>string</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/workflow/crs.html#from_string"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#workflow.crs.from_string" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a CRS from a Proj4 string specification.</p>
</dd></dl>

<dl class="function">
<dt id="workflow.crs.latlon_crs">
<code class="descclassname">workflow.crs.</code><code class="descname">latlon_crs</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/workflow/crs.html#latlon_crs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#workflow.crs.latlon_crs" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the default latitude-longitude CRS.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>out</strong> <span class="classifier-delimiter">:</span> <span class="classifier">crs-type</span></dt>
<dd><p class="first last">The default CRS.  The user should not care what this is (if
you do, don’t use the default!) but it is EPSG:4269.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="workflow.crs.to_cartopy">
<code class="descclassname">workflow.crs.</code><code class="descname">to_cartopy</code><span class="sig-paren">(</span><em>crs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/workflow/crs.html#to_cartopy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#workflow.crs.to_cartopy" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts a workflow CRS to a cartopy.crs.Projection.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>crs</strong> <span class="classifier-delimiter">:</span> <span class="classifier">crs-type</span></dt>
<dd><p class="first last">The CRS to convert.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt>A cartopy.crs.Projection object for plotting.</dt>
<dd></dd>
<dt>Adapted from: <a class="reference external" href="https://github.com/fmaussion/salem/blob/d0aaefab96bd4099c280d5088d4e66b52d20b72b/salem/gis.py#L901-L983">https://github.com/fmaussion/salem/blob/d0aaefab96bd4099c280d5088d4e66b52d20b72b/salem/gis.py#L901-L983</a></dt>
<dd></dd>
<dt>Better solution blocked by: <a class="reference external" href="https://github.com/SciTools/cartopy/issues/813">https://github.com/SciTools/cartopy/issues/813</a></dt>
<dd></dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="workflow.crs.to_fiona">
<code class="descclassname">workflow.crs.</code><code class="descname">to_fiona</code><span class="sig-paren">(</span><em>crs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/workflow/crs.html#to_fiona"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#workflow.crs.to_fiona" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts a workflow CRS to a fiona CRS.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>crs</strong> <span class="classifier-delimiter">:</span> <span class="classifier">crs-type</span></dt>
<dd><p class="first last">A workflow CRS object.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>out</strong> <span class="classifier-delimiter">:</span> <span class="classifier">fiona-crs-dict</span></dt>
<dd><p class="first last">Equivalent fiona CRS.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="workflow.crs.to_proj">
<code class="descclassname">workflow.crs.</code><code class="descname">to_proj</code><span class="sig-paren">(</span><em>crs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/workflow/crs.html#to_proj"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#workflow.crs.to_proj" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts a workflow CRS standard to a Proj4 CRS.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>crs</strong> <span class="classifier-delimiter">:</span> <span class="classifier">crs-type</span></dt>
<dd><p class="first last">Workflow standard CRS.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>out</strong> <span class="classifier-delimiter">:</span> <span class="classifier">pyproj.Proj</span></dt>
<dd><p class="first last">Equivalent object.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="workflow.crs.to_rasterio">
<code class="descclassname">workflow.crs.</code><code class="descname">to_rasterio</code><span class="sig-paren">(</span><em>crs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/workflow/crs.html#to_rasterio"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#workflow.crs.to_rasterio" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts a workflow CRS to a fiona CRS.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>crs</strong> <span class="classifier-delimiter">:</span> <span class="classifier">crs-type</span></dt>
<dd><p class="first last">A workflow CRS object.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>out</strong> <span class="classifier-delimiter">:</span> <span class="classifier">fiona-crs-dict</span></dt>
<dd><p class="first last">Equivalent fiona CRS.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="workflow.crs.to_string">
<code class="descclassname">workflow.crs.</code><code class="descname">to_string</code><span class="sig-paren">(</span><em>crs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/workflow/crs.html#to_string"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#workflow.crs.to_string" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the proj4 string of a CRS.</p>
</dd></dl>

</div>
<div class="section" id="shapes-and-shapely">
<h3>shapes and shapely<a class="headerlink" href="#shapes-and-shapely" title="Permalink to this headline">¶</a></h3>
<p>TODO: fiona shapes vs shapely shapes</p>
</div>
</div>
<div class="section" id="module-workflow.hilev">
<span id="high-level-api"></span><h2>High Level API<a class="headerlink" href="#module-workflow.hilev" title="Permalink to this headline">¶</a></h2>
<p>Watershed Workflow finds, downloads, and processes data for use in hydrologic models.</p>
<p>This package is a python library of tools for interacting with a wide range of
data streams using free and open (both free as in freedom and free as in free
beer) python and GIS libraries and data.  Critically, this package provides a
way for <strong>automatically and quickly</strong> downloading, interpreting, and processing
data needed to <strong>generate a “first” hyper-resolution simulation on any
watershed</strong> in the conterminous United States (and most of Alaska/Hawaii/Puerto
Rico).</p>
<p>To do this, this package provides tools to automate finding (via REST APIs and
other approaches) data streams from <strong>open data streams,</strong> from United States
governmental agencies, including USGS, USDA, DOE, and others.  These data
streams are then colocated on a mesh which is generated based on a watershed
delineation and a river network, and that mesh is written in one of a variety
of mesh formats for use in hyper-resolution simulation tools.</p>
<p>This top level module provides functionality for getting shapes and rasters
representing watershed boundaries, river networks, digital elevation models,
and other GIS datasets and then processing those data sets for use in
simulations.</p>
<dl class="function">
<dt id="workflow.hilev.get_huc">
<code class="descclassname">workflow.hilev.</code><code class="descname">get_huc</code><span class="sig-paren">(</span><em>source</em>, <em>huc</em>, <em>crs=None</em>, <em>digits=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/workflow/hilev.html#get_huc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#workflow.hilev.get_huc" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a HUC shape object from a given code.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>source</strong> <span class="classifier-delimiter">:</span> <span class="classifier">source-type</span></dt>
<dd><p class="first last">source object providing <cite>get_hucs()</cite></p>
</dd>
<dt><strong>huc</strong> <span class="classifier-delimiter">:</span> <span class="classifier">str</span></dt>
<dd><p class="first last">hydrologic unit code</p>
</dd>
<dt><strong>crs</strong> <span class="classifier-delimiter">:</span> <span class="classifier">crs-type</span></dt>
<dd><p class="first last">Output coordinate system.  Default is source’s crs.</p>
</dd>
<dt><strong>digits</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, optional</span></dt>
<dd><p class="first last">Number of digits to round coordinates to.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>out_crs</strong> <span class="classifier-delimiter">:</span> <span class="classifier">crs-type</span></dt>
<dd><p class="first last">Coordinate system of <cite>out</cite>.</p>
</dd>
<dt><strong>out</strong> <span class="classifier-delimiter">:</span> <span class="classifier">Polygon</span></dt>
<dd><p class="first last">shapely polygon for the hydrologic unit.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="workflow.hilev.get_hucs">
<code class="descclassname">workflow.hilev.</code><code class="descname">get_hucs</code><span class="sig-paren">(</span><em>source</em>, <em>huc</em>, <em>level</em>, <em>crs=None</em>, <em>digits=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/workflow/hilev.html#get_hucs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#workflow.hilev.get_hucs" title="Permalink to this definition">¶</a></dt>
<dd><p>Get shape objects for all HUCs at a level contained in huc.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>source</strong> <span class="classifier-delimiter">:</span> <span class="classifier">source-type</span></dt>
<dd><p class="first last">source object providing <cite>get_hucs()</cite></p>
</dd>
<dt><strong>huc</strong> <span class="classifier-delimiter">:</span> <span class="classifier">str</span></dt>
<dd><p class="first last">hydrologic unit code</p>
</dd>
<dt><strong>level</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd><p class="first last">HUC level of the requested sub-basins</p>
</dd>
<dt><strong>crs</strong> <span class="classifier-delimiter">:</span> <span class="classifier">crs-type</span></dt>
<dd><p class="first last">Output coordinate system.  Default is source’s crs.</p>
</dd>
<dt><strong>digits</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, optional</span></dt>
<dd><p class="first last">Number of digits to round coordinates to.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>out_crs</strong> <span class="classifier-delimiter">:</span> <span class="classifier">crs-type</span></dt>
<dd><p class="first last">Coordinate system of all entries in <cite>out</cite>.</p>
</dd>
<dt><strong>out</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list(Polygon)</span></dt>
<dd><p class="first last">List of shapely polygons for the subbasins.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="workflow.hilev.get_split_form_hucs">
<code class="descclassname">workflow.hilev.</code><code class="descname">get_split_form_hucs</code><span class="sig-paren">(</span><em>source</em>, <em>huc</em>, <em>level=None</em>, <em>crs=None</em>, <em>digits=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/workflow/hilev.html#get_split_form_hucs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#workflow.hilev.get_split_form_hucs" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a SplitHUCs object for all HUCs at level contained in huc.</p>
<p>A SplitHUCs object is an object which stores a collection of polygons which
share boundaries in a format that makes changing those shared boundaries
possible without having to update all shapes that share the boundary.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>source</strong> <span class="classifier-delimiter">:</span> <span class="classifier">source-type</span></dt>
<dd><p class="first last">source object providing <cite>get_hucs()</cite></p>
</dd>
<dt><strong>huc</strong> <span class="classifier-delimiter">:</span> <span class="classifier">str</span></dt>
<dd><p class="first last">hydrologic unit code</p>
</dd>
<dt><strong>level</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd><p class="first last">HUC level of the requested sub-basins</p>
</dd>
<dt><strong>crs</strong> <span class="classifier-delimiter">:</span> <span class="classifier">crs-type</span></dt>
<dd><p class="first last">Output coordinate system.  Default is source’s crs.</p>
</dd>
<dt><strong>digits</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, optional</span></dt>
<dd><p class="first last">Number of digits to round coordinates to.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>out_crs</strong> <span class="classifier-delimiter">:</span> <span class="classifier">crs-type</span></dt>
<dd><p class="first last">Coordinate system of <cite>out</cite>.</p>
</dd>
<dt><strong>out</strong> <span class="classifier-delimiter">:</span> <span class="classifier">SplitHUCs</span></dt>
<dd><p class="first last">Split-form HUCs object containing subbasins.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="workflow.hilev.get_shapes">
<code class="descclassname">workflow.hilev.</code><code class="descname">get_shapes</code><span class="sig-paren">(</span><em>source</em>, <em>index_or_bounds=None</em>, <em>crs=None</em>, <em>digits=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/workflow/hilev.html#get_shapes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#workflow.hilev.get_shapes" title="Permalink to this definition">¶</a></dt>
<dd><p>Read a shapefile.</p>
<p>If index_or_bounds is a bounding box, crs must not be None and is the crs
of the bounding box.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>source</strong> <span class="classifier-delimiter">:</span> <span class="classifier">str or source-type</span></dt>
<dd><p class="first last">Filename to parse, or a source object providing the get_shapes()
method.</p>
</dd>
<dt><strong>index_or_bounds</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int or [x_min, y_min, x_max, y_max] bounds, optional</span></dt>
<dd><p class="first last">Filter the file, either by selecting a specific shape by index of the
requested shape in the file, or providing a bounds-type tuple to select
only shapes that intersect with the bounding box.</p>
</dd>
<dt><strong>crs</strong> <span class="classifier-delimiter">:</span> <span class="classifier">crs-type, optional</span></dt>
<dd><p class="first last">Coordinate system of out and/or the bounding box provided in <cite>filter</cite>.
The default is source’s crs.</p>
</dd>
<dt><strong>digits</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, optional</span></dt>
<dd><p class="first last">Number of digits to round coordinates to.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>out_crs</strong> <span class="classifier-delimiter">:</span> <span class="classifier">crs-type</span></dt>
<dd><p class="first last">Coordinate system of <cite>out</cite>.</p>
</dd>
<dt><strong>out</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list(shapely)</span></dt>
<dd><p class="first last">List of shapely objects in the shapefile meeting the criteria.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="workflow.hilev.get_split_form_shapes">
<code class="descclassname">workflow.hilev.</code><code class="descname">get_split_form_shapes</code><span class="sig-paren">(</span><em>source</em>, <em>index_or_bounds=-1</em>, <em>crs=None</em>, <em>digits=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/workflow/hilev.html#get_split_form_shapes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#workflow.hilev.get_split_form_shapes" title="Permalink to this definition">¶</a></dt>
<dd><p>Read a shapefile.</p>
<p>Note that if index_or_bounds is a bounding box, crs must not be None and is
the crs of the bounding box.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>source</strong> <span class="classifier-delimiter">:</span> <span class="classifier">str or source-type</span></dt>
<dd><p class="first last">Filename to parse, or a source object providing the get_shapes() method.</p>
</dd>
<dt><strong>index_or_bounds</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int or [x_min, y_min, x_max, y_max] bounds, optional</span></dt>
<dd><p class="first last">Filter the shapes, either by selecting a specific shape by index of the
requested shape in the file, or providing a bounds-type tuple to select
only shapes that intersect with the bounding box.</p>
</dd>
<dt><strong>crs</strong> <span class="classifier-delimiter">:</span> <span class="classifier">crs-type, optional</span></dt>
<dd><p class="first last">Coordinate system of out and/or the bounding box provided in <cite>filter</cite>.
The default is source’s crs.</p>
</dd>
<dt><strong>digits</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, optional</span></dt>
<dd><p class="first last">Number of digits to round coordinates to.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>out_crs</strong> <span class="classifier-delimiter">:</span> <span class="classifier">crs-type</span></dt>
<dd><p class="first last">Coordinate system of <cite>out</cite>.</p>
</dd>
<dt><strong>out</strong> <span class="classifier-delimiter">:</span> <span class="classifier">SplitHUCs</span></dt>
<dd><p class="first last">Split-form polygons object containing subbasins.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="workflow.hilev.get_reaches">
<code class="descclassname">workflow.hilev.</code><code class="descname">get_reaches</code><span class="sig-paren">(</span><em>source</em>, <em>huc</em>, <em>bounds=None</em>, <em>crs=None</em>, <em>digits=None</em>, <em>long=None</em>, <em>merge=True</em>, <em>presimplify=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/workflow/hilev.html#get_reaches"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#workflow.hilev.get_reaches" title="Permalink to this definition">¶</a></dt>
<dd><p>Get reaches from hydrography source within a given HUC and/or bounding box.</p>
<p>Collects reach datasets within a HUC and/or a bounding box.  If bounds are
provided, a containing HUC must still be provided to give a hint for file
downloads.  If bounds are not provided, then all reaches that intersect the
HUC are included.</p>
<p>If bounds is provided, crs must not be None and is the crs of the bounding box.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>source</strong> <span class="classifier-delimiter">:</span> <span class="classifier">source-type</span></dt>
<dd><p class="first last">Source object providing a get_hydro() method.</p>
</dd>
<dt><strong>huc</strong> <span class="classifier-delimiter">:</span> <span class="classifier">str</span></dt>
<dd><p class="first last">HUC containing reaches.  If bounds are provided, a hint to help the
source find the file containing the bounds.  For NHD, this is a HUC4 or
smaller.</p>
</dd>
<dt><strong>bounds</strong> <span class="classifier-delimiter">:</span> <span class="classifier">[xmin, ymin, xmax, ymax] bounds, optional</span></dt>
<dd><p class="first last">Bounding box to filter the river network.</p>
</dd>
<dt><strong>crs</strong> <span class="classifier-delimiter">:</span> <span class="classifier">crs-type, optional</span></dt>
<dd><p class="first last">Output coordinate system and coordinate system of bounds.  Defaults to
the source’s crs.</p>
</dd>
<dt><strong>digits</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, optional</span></dt>
<dd><p class="first last">Number of digits to round coordinates to.</p>
</dd>
<dt><strong>long</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float, optional</span></dt>
<dd><p class="first last">If a reach is longer than this value it gets filtered.  Some NHD data
has QC issues, or other wierd extra-long, single segment reaches that
don’t make sense…</p>
</dd>
<dt><strong>merge</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool, optional</span></dt>
<dd><p class="first last">If true, reaches are merged (via shapely.ops.linemerge), collapsing 
connected, non-branching reaches into a single LineString.</p>
</dd>
<dt><strong>presimplify</strong> <span class="classifier-delimiter">:</span> <span class="classifier">double, optional</span></dt>
<dd><p class="first last">If provided, reaches are simplified according to shapely.simplify as 
soon as possible for big extents.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>out_crs</strong> <span class="classifier-delimiter">:</span> <span class="classifier">crs-type</span></dt>
<dd><p class="first last">Coordinate system of <cite>out</cite>.</p>
</dd>
<dt><strong>out</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list(LineString)</span></dt>
<dd><p class="first last">Reaches in the HUC and/or intersecting the bounds.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="workflow.hilev.get_raster_on_shape">
<code class="descclassname">workflow.hilev.</code><code class="descname">get_raster_on_shape</code><span class="sig-paren">(</span><em>source</em>, <em>shape</em>, <em>crs</em>, <em>raster_crs=None</em>, <em>buffer=0.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/workflow/hilev.html#get_raster_on_shape"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#workflow.hilev.get_raster_on_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Collects a raster DEM that covers the requested shape.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>source</strong> <span class="classifier-delimiter">:</span> <span class="classifier">source-type</span></dt>
<dd><p class="first last">Source object providing a get_raster() method.</p>
</dd>
<dt><strong>shape</strong> <span class="classifier-delimiter">:</span> <span class="classifier">Polygon</span></dt>
<dd><p class="first last">Shapely or fiona polygon on which to get the raster.</p>
</dd>
<dt><strong>crs</strong> <span class="classifier-delimiter">:</span> <span class="classifier">crs-type</span></dt>
<dd><p class="first last">CRS of shape.</p>
</dd>
<dt><strong>raster_crs</strong> <span class="classifier-delimiter">:</span> <span class="classifier">crs-type, optional</span></dt>
<dd><p class="first last">Output crs.  Defaults to the source’s crs.</p>
</dd>
<dt><strong>buffer</strong> <span class="classifier-delimiter">:</span> <span class="classifier">double, optional</span></dt>
<dd><p class="first last">Size of a buffer, in units of the shape’s CRS, added to shape to ensure
pixels cover the entire shape.  Default is 0.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>profile</strong> <span class="classifier-delimiter">:</span> <span class="classifier">dict</span></dt>
<dd><p class="first last">Rasterio profile of the image including rasterio CRS and transform</p>
</dd>
<dt><strong>raster</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray</span></dt>
<dd><p class="first last">The raster data in a 2D-array.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="workflow.hilev.get_masked_raster_on_shape">
<code class="descclassname">workflow.hilev.</code><code class="descname">get_masked_raster_on_shape</code><span class="sig-paren">(</span><em>source</em>, <em>shape</em>, <em>crs</em>, <em>nodata=-1</em>, <em>buffer=0.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/workflow/hilev.html#get_masked_raster_on_shape"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#workflow.hilev.get_masked_raster_on_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Collects a raster that is masked to the requested shape.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>source</strong> <span class="classifier-delimiter">:</span> <span class="classifier">source-type</span></dt>
<dd><p class="first last">Source object providing a get_raster() method.</p>
</dd>
<dt><strong>shape</strong> <span class="classifier-delimiter">:</span> <span class="classifier">Polygon</span></dt>
<dd><p class="first last">Shapely or fiona polygon on which to get the raster.</p>
</dd>
<dt><strong>crs</strong> <span class="classifier-delimiter">:</span> <span class="classifier">crs-type</span></dt>
<dd><p class="first last">CRS of shape.</p>
</dd>
<dt><strong>nodata</strong> <span class="classifier-delimiter">:</span> <span class="classifier">dtype, optional</span></dt>
<dd><p class="first last">Value to place in the array outside of shape.  Note that the type of
this value should be the same as the data in the raster.  Default is
-1.</p>
</dd>
<dt><strong>buffer</strong> <span class="classifier-delimiter">:</span> <span class="classifier">double, optional</span></dt>
<dd><p class="first last">Size of a buffer, in units of the shape’s CRS, added to shape to ensure
pixels cover the entire shape.  Default is 0.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>profile</strong> <span class="classifier-delimiter">:</span> <span class="classifier">dict</span></dt>
<dd><p class="first last">Rasterio profile of the image including rasterio CRS and transform</p>
</dd>
<dt><strong>raster</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray</span></dt>
<dd><p class="first last">The raster data in a 2D-array.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="workflow.hilev.find_huc">
<code class="descclassname">workflow.hilev.</code><code class="descname">find_huc</code><span class="sig-paren">(</span><em>source</em>, <em>shape</em>, <em>crs</em>, <em>hint</em>, <em>shrink_factor=1e-05</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/workflow/hilev.html#find_huc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#workflow.hilev.find_huc" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds the smallest HUC containing shp.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>source</strong> <span class="classifier-delimiter">:</span> <span class="classifier">source-type</span></dt>
<dd><p class="first last">Source object providing a get_hucs() method.</p>
</dd>
<dt><strong>shape</strong> <span class="classifier-delimiter">:</span> <span class="classifier">Polygon</span></dt>
<dd><p class="first last">Shapely or fiona polygon on which to get the raster.</p>
</dd>
<dt><strong>crs</strong> <span class="classifier-delimiter">:</span> <span class="classifier">crs-type</span></dt>
<dd><p class="first last">CRS of shape.</p>
</dd>
<dt><strong>hint</strong> <span class="classifier-delimiter">:</span> <span class="classifier">str</span></dt>
<dd><p class="first last">HUC in which to start searching.  This should be at least as long as
the indexing file size – HUC 2 or longer for WBD, 4 or longer for NHD
Plus, or 8 or longer for NHD.</p>
</dd>
<dt><strong>shrink_factor</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float, optional</span></dt>
<dd><p class="first last">A fraction of the radius of shape to shrink prior for checking
containment within HUCs.  This fixes cases where shape is on a HUC
boundary with potentially some numerical error.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>out</strong> <span class="classifier-delimiter">:</span> <span class="classifier">str</span></dt>
<dd><p class="first last">The smallest containing HUC.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="workflow.hilev.simplify_and_prune">
<code class="descclassname">workflow.hilev.</code><code class="descname">simplify_and_prune</code><span class="sig-paren">(</span><em>hucs</em>, <em>reaches</em>, <em>filter=True</em>, <em>simplify=10</em>, <em>prune_reach_size=0</em>, <em>cut_intersections=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/workflow/hilev.html#simplify_and_prune"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#workflow.hilev.simplify_and_prune" title="Permalink to this definition">¶</a></dt>
<dd><p>Cleans up the HUC and river shapes.</p>
<p>Ensures intersections are proper, snapped, simplified, etc.  Note, HUCs and
rivers must be in the same crs.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>hucs</strong> <span class="classifier-delimiter">:</span> <span class="classifier">SplitHUCs</span></dt>
<dd><p class="first last">A split-form HUC object containing all reaches.</p>
</dd>
<dt><strong>reaches</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list(LineString)</span></dt>
<dd><p class="first last">A list of reaches.</p>
</dd>
<dt><strong>simplify</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float, optional</span></dt>
<dd><p class="first last">Argument to shapely’s simplify, a measure of how far to allow shapes to
move.  Default is 10 (units are in that of the CRS of hucs and
reaches).</p>
</dd>
<dt><strong>prune_river_size</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int, optional</span></dt>
<dd><p class="first last">Remove rivers with fewer than this number of reaches.  Default is 0.</p>
</dd>
<dt><strong>cut_intersections</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool</span></dt>
<dd><p class="first last">Cut HUC segments at the river input/output, potentially resulting in
simpler geometries.  This is work in progress.  Default is False.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>out</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list(RiverTree)</span></dt>
<dd><p class="first last">A list of rivers, as RiverTree objects.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="workflow.hilev.triangulate">
<code class="descclassname">workflow.hilev.</code><code class="descname">triangulate</code><span class="sig-paren">(</span><em>hucs</em>, <em>rivers</em>, <em>diagnostics=True</em>, <em>verbosity=1</em>, <em>refine_max_area=None</em>, <em>refine_distance=None</em>, <em>refine_max_edge_length=None</em>, <em>refine_min_angle=None</em>, <em>enforce_delaunay=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/workflow/hilev.html#triangulate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#workflow.hilev.triangulate" title="Permalink to this definition">¶</a></dt>
<dd><p>Triangulates HUCs and rivers.</p>
<p>Note, refinement of a given triangle is done if any of the provided
criteria is met.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>hucs</strong> <span class="classifier-delimiter">:</span> <span class="classifier">SplitHUCs</span></dt>
<dd><p class="first last">A split-form HUC object from, e.g., get_split_form_hucs()</p>
</dd>
<dt><strong>reaches</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list(LineString)</span></dt>
<dd><p class="first last">A list of reaches from, e.g., get_reaches()</p>
</dd>
<dt><strong>diagnostics</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool, optional</span></dt>
<dd><p class="first last">Plot diagnostics graphs of the triangle refinement.</p>
</dd>
<dt><strong>refine_max_area</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float, optional</span></dt>
<dd><p class="first last">Refine a triangle if its area is greater than this area.</p>
</dd>
<dt><strong>refine_distance</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list(float), optional</span></dt>
<dd><p class="first">Refine a triangle if its area is greater than a function of its
centroid’s distance from the nearest point on the river network.  The
argument is given by:</p>
<p>[near_distance, near_area, far_distance, far_area]</p>
<p>Defining d as the distance from triangle centroid to the nearest point
on the river network and area as the area of the triangle in question,
refinement occurs if:</p>
<ul class="simple">
<li>d &lt; near_distance and area &gt; near_area</li>
<li>d &gt; far_distance and area &gt; far_area</li>
<li>otherwise, defining 
d’ = (d - near_distance) / (far_distance - near_distance),
refining occurs if
area &gt; near_area + (far_area - near_area) * d’</li>
</ul>
<p class="last">Effectively this simply writes a piecewise linear function of triangle
distance from centroid and uses that as a max area criteria.</p>
</dd>
<dt><strong>refine_max_edge_length</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float, optional</span></dt>
<dd><p class="first last">Refine a triangle if its max edge length is greater than this length.</p>
</dd>
<dt><strong>refine_min_angle</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float, optional</span></dt>
<dd><p class="first last">Try to ensure that all triangles have a minimum edge length greater
than this value.</p>
</dd>
<dt><strong>enforce_delaunay</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool,optional, experimental</span></dt>
<dd><p class="first last">Attempt to ensure all triangles are proper Delaunay triangles.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>vertices</strong> <span class="classifier-delimiter">:</span> <span class="classifier">np.array((n_points, 2), ‘d’)</span></dt>
<dd><p class="first last">Array of triangle vertices.</p>
</dd>
<dt><strong>triangles</strong> <span class="classifier-delimiter">:</span> <span class="classifier">np.array((n_tris, 3), ‘i’)</span></dt>
<dd><p class="first last">For each triangle, a list of 3 indices into the vertex array that make
up that triangle.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="workflow.hilev.elevate">
<code class="descclassname">workflow.hilev.</code><code class="descname">elevate</code><span class="sig-paren">(</span><em>mesh_points</em>, <em>mesh_crs</em>, <em>dem</em>, <em>dem_profile</em>, <em>algorithm='piecewise bilinear'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/workflow/hilev.html#elevate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#workflow.hilev.elevate" title="Permalink to this definition">¶</a></dt>
<dd><p>Elevate mesh_points onto the provided dem.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>mesh_points</strong> <span class="classifier-delimiter">:</span> <span class="classifier">np.array((n_points, 2), ‘d’)</span></dt>
<dd><p class="first last">Array of triangle vertices.</p>
</dd>
<dt><strong>mesh_crs</strong> <span class="classifier-delimiter">:</span> <span class="classifier">crs-type</span></dt>
<dd><p class="first last">Mesh coordinate system.</p>
</dd>
<dt><strong>dem</strong> <span class="classifier-delimiter">:</span> <span class="classifier">np.array</span></dt>
<dd><p class="first last">2D array forming an elevation raster.</p>
</dd>
<dt><strong>dem_profile</strong> <span class="classifier-delimiter">:</span> <span class="classifier">dict</span></dt>
<dd><p class="first last">rasterio profile for the elevation raster.</p>
</dd>
<dt><strong>algorithm</strong> <span class="classifier-delimiter">:</span> <span class="classifier">str, optional</span></dt>
<dd><p class="first last">Algorithm used for interpolation.  One of:
* “nearest” for nearest-neighbor pixels
* “piecewise bilinear” for interpolation</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>out</strong> <span class="classifier-delimiter">:</span> <span class="classifier">np.array((n_points, 3), ‘d’)</span></dt>
<dd><p class="first last">Array of triangle vertices, including a z-dimension.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="workflow.hilev.values_from_raster">
<code class="descclassname">workflow.hilev.</code><code class="descname">values_from_raster</code><span class="sig-paren">(</span><em>points</em>, <em>points_crs</em>, <em>raster</em>, <em>raster_profile</em>, <em>algorithm='nearest'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/workflow/hilev.html#values_from_raster"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#workflow.hilev.values_from_raster" title="Permalink to this definition">¶</a></dt>
<dd><p>Interpolate a raster onto a collection of unstructured points.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>points</strong> <span class="classifier-delimiter">:</span> <span class="classifier">np.array((n_points, 2), ‘d’)</span></dt>
<dd><p class="first last">Array of points to interpolate onto.</p>
</dd>
<dt><strong>points_crs</strong> <span class="classifier-delimiter">:</span> <span class="classifier">crs-type</span></dt>
<dd><p class="first last">Coordinate system of the points.</p>
</dd>
<dt><strong>raster</strong> <span class="classifier-delimiter">:</span> <span class="classifier">np.array</span></dt>
<dd><p class="first last">2D array forming the raster.</p>
</dd>
<dt><strong>raster_profile</strong> <span class="classifier-delimiter">:</span> <span class="classifier">dict</span></dt>
<dd><p class="first last">rasterio profile for the raster.</p>
</dd>
<dt><strong>algorithm</strong> <span class="classifier-delimiter">:</span> <span class="classifier">str</span></dt>
<dd><p class="first last">Algorithm used for interpolation.  One of:
* “nearest” for nearest neighbor pixels
* “piecewise bilinear” for interpolation</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>out</strong> <span class="classifier-delimiter">:</span> <span class="classifier">np.array((n_points,))</span></dt>
<dd><p class="first last">Array of raster values interpolated onto the points.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="workflow.hilev.color_raster_from_shapes">
<code class="descclassname">workflow.hilev.</code><code class="descname">color_raster_from_shapes</code><span class="sig-paren">(</span><em>target_bounds</em>, <em>target_dx</em>, <em>shapes</em>, <em>shape_colors</em>, <em>shapes_crs</em>, <em>nodata=-1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/workflow/hilev.html#color_raster_from_shapes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#workflow.hilev.color_raster_from_shapes" title="Permalink to this definition">¶</a></dt>
<dd><p>Color in a raster by filling in a collection of shapes.</p>
<p>Given a canvas specified by bounds and pixel size, color a raster by, for
each shape, finding the intersection of that shape with the canvas and
coloring it by a provided value.  Paint by numbers.</p>
<p>Note, if the shapes overlap, the last shape containing a pixel gives the
color of that pixel.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>target_bounds</strong> <span class="classifier-delimiter">:</span> <span class="classifier">[xmin, ymin, xmax, ymax]</span></dt>
<dd><p class="first last">Bounding box for the output raster.</p>
</dd>
<dt><strong>target_dx</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">Pixel size (assumed the same in both x and y).</p>
</dd>
<dt><strong>shapes</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list(Polygon)</span></dt>
<dd><p class="first last">Collection of shapes (likely) overlapping the canvas.</p>
</dd>
<dt><strong>shapes_colors</strong> <span class="classifier-delimiter">:</span> <span class="classifier">np.array((n_shapes,), dtype)</span></dt>
<dd><p class="first last">Color to label the interior of each polygon with.</p>
</dd>
<dt><strong>shapes_crs</strong> <span class="classifier-delimiter">:</span> <span class="classifier">crs-type</span></dt>
<dd><p class="first last">Coordinate system of the shapes.</p>
</dd>
<dt><strong>nodata</strong> <span class="classifier-delimiter">:</span> <span class="classifier">dtype, optional</span></dt>
<dd><p class="first last">Value to place in pixels which intersect no shape.  Note the type of
this should be the same as the type of shape_colors.  Default is -1.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>out</strong> <span class="classifier-delimiter">:</span> <span class="classifier">np.array(target_bounds, dtype)</span></dt>
<dd><p class="first last">Raster of colors.</p>
</dd>
<dt><strong>out_profile</strong> <span class="classifier-delimiter">:</span> <span class="classifier">dict</span></dt>
<dd><p class="first last">rasterio profile of the color raster.</p>
</dd>
<dt><strong>out_bounds</strong> <span class="classifier-delimiter">:</span> <span class="classifier">[x_min, y_min, x_max, y_max]</span></dt>
<dd><p class="first last">Physial bounds of the resulting image.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="sources-api">
<h2>Sources API<a class="headerlink" href="#sources-api" title="Permalink to this headline">¶</a></h2>
<p id="source-type">Source objects provide ways of downloading and using data.</p>
</div>
<div class="section" id="module-workflow.utils">
<span id="utils-api"></span><h2>utils API<a class="headerlink" href="#module-workflow.utils" title="Permalink to this headline">¶</a></h2>
<p>Shape and geometry utilities for working with fiona and shapely objects.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="sources.html" class="btn btn-neutral float-left" title="Data Sources" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, UT Battelle, Ethan Coon

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>